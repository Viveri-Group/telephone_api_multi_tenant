[www]
; SECURITY: Run as www-data user (required for production)
user = www-data
group = www-data

; NETWORKING: Critical fix for container communication
listen = 0.0.0.0:9000

; HIGH CONCURRENCY: Increase backlog for burst traffic
listen.backlog = 1024

; HIGH CONCURRENCY: Process management optimized for HIGH-SPEC production machine
; BURST TRAFFIC: Increased to 300 to handle extreme load with upgraded hardware
; Assumes: 8GB+ RAM, 4+ CPU cores per container
pm = dynamic
pm.max_children = 300
pm.start_servers = 50
pm.min_spare_servers = 50
pm.max_spare_servers = 200
pm.max_requests = 1000   ; recycle to avoid leaks

; MONITORING: Enable status page for performance monitoring
pm.status_path = /fpm-status

; MONITORING: Enable ping endpoint for health checks
ping.path = /fmp-ping
ping.response = healthy

; MONITORING: Log slow requests for performance analysis
slowlog = /proc/self/fd/2
request_slowlog_timeout = 0.2s

; STABILITY: Match php.ini max_execution_time + buffer for cleanup
request_terminate_timeout = 130s

; HIGH CONCURRENCY: Increase file descriptor limit
rlimit_files = 4096

; SECURITY: Enable worker output logging for debugging
catch_workers_output = yes

; SECURITY: Restrict PHP file extensions for safety
security.limit_extensions = .php
